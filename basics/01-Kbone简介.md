# Kbone 简介

### 1、导语

小程序作为一种新兴地链接用户与服务的方式，相信大家都或多或少接触过。对于开发者来说，它是一种类似 Web 但又不同于 Web 的开发模式，它提供了一套自定义的 API 和文件组织方式，这无疑带给开发者一定的学习成本和维护成本，所以我们也在尝试能否提供一个方案来抹平这个差异。——引自Kbone作者june在云加社区微信群中的分享

随着小程序的发展，Web 端和小程序同构的呼声也越来越大，为此微信官方提供了 Kbone 这一套方案。旨在让开发者可以用最熟悉的方式来完成一个多端 APP 的开发，降低开发门槛。

Kbone——微信小程序同构方案新思路。

微信小程序的底层模型和 Web 端不同，我们想直接把 Web 端的代码挪到小程序环境内执行是不可能的。kbone 的诞生就是为了解决这个问题，它实现了一个适配器，在适配层里模拟出了浏览器环境，让 Web 端的代码可以不做什么改动便可运行在小程序里。

### 2、Kbone的优势

因为 kbone 是通过提供适配器的方式来实现同构，所以它的优势很明显：

- 大部分流行的前端框架都能够在 kbone 上运行，比如 Vue、React、Preact 等。
- 支持更为完整的前端框架特性，因为 kbone 不会对框架底层进行删改（比如 Vue 中的 v-html 指令、Vue-router 插件）。
- 提供了常用的 dom/bom 接口，让用户代码无需做太大改动便可从 Web 端迁移到小程序端。
- 在小程序端运行时，仍然可以使用小程序本身的特性（比如像 live-player 内置组件、分包功能）。
- 提供了一些 Dom 扩展接口，让一些无法完美兼容到小程序端的接口也有替代使用方案（比如 getComputedStyle 接口）。

### 3、Kbone 诞生背景

首先我们先进入背景部分的介绍。之所以会有 Kbone 这个方案出现，源自于一个需求：微信开放社区当时只有 Web 端，为了让信息可以更方便地传播、分享和使用，希望实现社区小程序版，交互体验尽量贴近于 Web 端。

微信开放社区链接：
https://developers.weixin.qq.com/community/develop/mixflow

此次同构到小程序端需要考虑几个因素：多端代码复用、尽可能支持已有的特性和性能要有保证。其实最主要的就是要在尽量不改动现有代码的情况下来完成小程序的开发。

### 4、选择

业内其实已经出现了很多关于同构的解决方案了，每个方案都有自己的优劣，不存在能够完美解决所有问题的方案。kbone 也一样，它的优势在上面提到过，而它的不足也是它的实现原理带来的。kbone 是使用一定的性能损耗来换取更为全面的 Web 端特性支持。

所以关于性能方面，如果你对小程序的性能特别苛刻，建议直接使用原生小程序开发；如果你的页面节点数量特别多（通常在 1000 节点以上），同时还要保证在节点数无限上涨时仍然有稳定的渲染性能的话，可以尝试一下业内采用静态模板转译的方案；其他情况就可以直接采用 kbone 了。

### 5、微信开放社区方案实现与应用效果

具体实现思路见 [高级 > 微信开放社区方案实现与应用效果](../advanced/01-微信开放社区方案实现与应用效果.md)。